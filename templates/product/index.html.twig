{% extends 'base-front.html.twig' %} {% block title %}Post index{% endblock %}
{% block body %}
<!-- Blog section -->
{#
<section class="blog-section spad">
  <div class="container">
    <div class="row">
      <div class="col-xl-9 col-lg-8 col-md-7">
        <div class="section-title text-white">
          <h2>Latest News</h2>
        </div>
        <ul class="blog-filter">
          <li><a href="#">Racing</a></li>
          <li><a href="#">Shooters</a></li>
          <li><a href="#">Strategy</a></li>
          <li><a href="#">Online</a></li>
        </ul>
        <!-- Blog item -->
        {% for product in products %}
        <div class="blog-item">
          <div class="blog-thumb">
            <img
              src="{{ asset('uploads/' ~ product.image) }}"
              alt=""
              width="100"
              height="100"
            />
          </div>
          <div class="blog-text text-box text-white">
            <div class="top-meta">
              11.11.18 / in <a href="">{{ product.idcat.name }}</a>
            </div>
            <h3>{{ product.name }}</h3>
            <h4>{{ product.price }}</h4>
            <p>{{ product.description }}</p>
            <a href="#" class="read-more"
              >Read More
              <img
                src="{{ asset('front/img/icons/double-arrow.png') }}"
                alt="#"
            /></a>
          </div>
        </div>
        {% else %}
        <tr>
          <td colspan="8">no products found</td>
        </tr>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
#}
<!-- Blog section end -->

<!-- Shop Start -->
<section class="blog-section spad">
  <div class="container">
    <div class="row">
      <div class="col-xl-9 col-lg-8 col-md-7">
        <div class="section-title text-white">
          <h2>Latest News</h2>
        </div>
        <div class="container-fluid pt-5">
          <div class="row px-xl-5">
            <!-- Shop Sidebar Start -->
            {# <div class="col-lg-3 col-md-12">
              <!-- Price Start -->
              <div class="border-bottom mb-4 pb-4">
                <h5 class="font-weight-semi-bold mb-4">Filter by price</h5>
                <form>
                  <div
                    class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3"
                  >
                    <input
                      type="checkbox"
                      class="custom-control-input"
                      checked
                      id="price-all"
                    />
                    <label class="custom-control-label" for="price-all"
                      >All Price</label
                    >
                    <span class="badge border font-weight-normal">1000</span>
                  </div>
                  <div
                    class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3"
                  >
                    <input
                      type="checkbox"
                      class="custom-control-input"
                      id="price-1"
                    />
                    <label class="custom-control-label" for="price-1"
                      >$0 - $100</label
                    >
                    <span class="badge border font-weight-normal">150</span>
                  </div>
                  <div
                    class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3"
                  >
                    <input
                      type="checkbox"
                      class="custom-control-input"
                      id="price-2"
                    />
                    <label class="custom-control-label" for="price-2"
                      >$100 - $200</label
                    >
                    <span class="badge border font-weight-normal">295</span>
                  </div>
                  <div
                    class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3"
                  >
                    <input
                      type="checkbox"
                      class="custom-control-input"
                      id="price-3"
                    />
                    <label class="custom-control-label" for="price-3"
                      >$200 - $300</label
                    >
                    <span class="badge border font-weight-normal">246</span>
                  </div>
                  <div
                    class="custom-control custom-checkbox d-flex align-items-center justify-content-between mb-3"
                  >
                    <input
                      type="checkbox"
                      class="custom-control-input"
                      id="price-4"
                    />
                    <label class="custom-control-label" for="price-4"
                      >$300 - $400</label
                    >
                    <span class="badge border font-weight-normal">145</span>
                  </div>
                  <div
                    class="custom-control custom-checkbox d-flex align-items-center justify-content-between"
                  >
                    <input
                      type="checkbox"
                      class="custom-control-input"
                      id="price-5"
                    />
                    <label class="custom-control-label" for="price-5"
                      >$400 - $500</label
                    >
                    <span class="badge border font-weight-normal">168</span>
                  </div>
                </form>
              </div>
              <!-- Price End -->
            </div> #}
            <!-- Shop Sidebar End -->

            <!-- Shop Product Start -->
                  {% block search %}
                  <form style="margin-bottom: 50px;">
                    <div class="input-group input-group-dynamic mb-8">
                      <input
                        type="text"
                        class="form-control"
                        placeholder="Search by name or description"
                        id="search"
                      />
                      <div class="input-group-append">
                        <span
                          class="input-group-text bg-transparent text-primary"
                        >
                          <i class="fa fa-search"></i>
                        </span>
                      </div>
                    </div>
                  </form>
                  {% endblock %}
            <div id="t" class="col-lg-9 col-md-12">
              <div id="all" class="row pb-3">
                {# <div class="col-12 pb-1">
                  <div
                    class="d-flex align-items-center justify-content-between mb-4"
                  >
                    <div class="dropdown ml-4">
                      <button
                        class="btn border dropdown-toggle"
                        type="button"
                        id="triggerId"
                        data-toggle="dropdown"
                        aria-haspopup="true"
                        aria-expanded="false"
                      >
                        Sort by
                      </button>
                      <div
                        class="dropdown-menu dropdown-menu-right"
                        aria-labelledby="triggerId"
                      >
                        <a class="dropdown-item" href="#">Latest</a>
                        <a class="dropdown-item" href="#">Popularity</a>
                        <a class="dropdown-item" href="#">Best Rating</a>
                      </div>
                    </div>
                  </div>
                </div> #}
                {% for product in products %}
                <div class="col-lg-4 col-md-6 col-sm-12 pb-1">
                  <div class="card product-item border-0 mb-4">
                    <div
                      class="card-header product-img position-relative overflow-hidden bg-transparent border p-0"
                    >
                      <img
                        src="{{ asset('uploads/' ~ product.image) }}"
                        alt=""
                        width="100"
                        height="100"
                      />
                    </div>
                    <div
                      class="card-body border-left border-right text-center p-0 pt-4 pb-3"
                    >
                      <h6 class="text-truncate mb-3">{{ product.name }}</h6>
                      <div class="d-flex justify-content-center">
                        <h6>{{ product.price }} TND</h6>
                        <h6 class="text-muted ml-2">
                          <del>{{ product.price }} TND</del>
                        </h6>
                      </div>
                    </div>
                    <div
                      class="card-footer d-flex justify-content-between bg-light border"
                    >
                      <a href="{{ path('app_product_show', { id: product.id })}}" class="btn btn-sm text-dark p-0">
                        <i class="fas fa-eye text-primary mr-1"></i>View Details
                      </a>
                      <a
                        href="{{ path('add_cart', { id: product.id }) }}"
                        class="btn btn-sm text-dark p-0"
                        ><i class="fas fa-shopping-cart text-primary mr-1"></i
                        >Add To Cart</a
                      >
                    </div>
                  </div>
                </div>
                {#
                <div class="blog-item">
                  <div class="blog-thumb"></div>
                  <div class="blog-text text-box text-white">
                    <div class="top-meta">
                      11.11.18 / in <a href="">{{ product.idcat.name }}</a>
                    </div>
                    <h3>{{ product.name }}</h3>
                    <h4>{{ product.price }}</h4>
                    <p>{{ product.description }}</p>
                    <a href="#" class="read-more"
                      >Read More
                      <img
                        src="{{ asset('front/img/icons/double-arrow.png') }}"
                        alt="#"
                    /></a>
                  </div>
                </div>
                #} {% else %}
                <tr>
                  <td colspan="8">no products found</td>
                </tr>
                {% endfor %}
                {{ knp_pagination_render(products) }}
                {#
                <div class="col-12 pb-1">
                  <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center mb-3">
                      <li class="page-item disabled">
                        <a class="page-link" href="#" aria-label="Previous">
                          <span aria-hidden="true">&laquo;</span>
                          <span class="sr-only">Previous</span>
                        </a>
                      </li>
                      <li class="page-item active">
                        <a class="page-link" href="#">1</a>
                      </li>
                      <li class="page-item">
                        <a class="page-link" href="#">2</a>
                      </li>
                      <li class="page-item">
                        <a class="page-link" href="#">3</a>
                      </li>
                      <li class="page-item">
                        <a class="page-link" href="#" aria-label="Next">
                          <span aria-hidden="true">&raquo;</span>
                          <span class="sr-only">Next</span>
                        </a>
                      </li>
                    </ul>
                  </nav>
                </div>
                #}
              </div>
              <div id="search" class="row pb-3"></div>
            </div>
            <!-- Shop Product End -->
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- Shop End -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
  $(document).ready(function () {
    $("#search").keyup(function (e) {
      /* La variable value va prendre la valeur insérer dans le champ de texte afin d’effectuer la recherche */
      var value = $(this).val();
      /* Ajax est lancé lors du remplissage du champ texte dont l’id est « search » pour faire la recherche */
      $.ajax({
        /* l’url est une chaine de caractères contenant l’adresse où la requête est envoyée */
        url: "{{ path('searchProd') }}",
        /* La méthode utilisée pour transférer les données est GET */
        type: "GET",
        
        /*Ici search value va prendre la chaine entrée par un utilisateur dans la zone de recherche et sera placée après l’url */
        data: {
          searchValue: value
        },
        /*Cette fonction permet de vider le contenu du tableau pour recevoir le nouveau contenu*/
        success: function (retour) {
          if (retour) {
            $("#t div#search").empty();

            $.each(JSON.parse(retour), function (o, obj) {
              $("#t div#all").hide();

              $("#t div#search").append('<div class="col-lg-4 col-md-6 col-sm-12 pb-1">');
              $("#t div#search").append('<div class="card product-item border-0 mb-4">');
              $("#t div#search").append('<div class="card-header product-img position-relative overflow-hidden bg-transparent border p-0">');
                var p = "/uploads/" + obj.image;
                var img = "<img src=" + p + " width='100' height='100'/>";
                $("#t div#search").append(img);
              $("#t div#search").append('</div>');
              $("#t div#search").append('<div class="card-body border-left border-right text-center p-0 pt-4 pb-3">');
              $("#t div#search").append('<h6 class="text-truncate mb-3">' + obj.name + '</h6>');
              $("#t div#search").append('<div class="d-flex justify-content-center">');
              $("#t div#search").append('<h6>' + obj.price + ' TND</h6>');
              $("#t div#search").append('</div>');
              $("#t div#search").append('</div>');
              $("#t div#search").append('<div class="card-footer d-flex justify-content-between bg-light border">');

              $("#t div#search").append('<i class="fas fa-eye text-primary mr-1"></i>View Details');

              $("#t div#search").append('<i class="fas fa-shopping-cart text-primary mr-1"></i>Add To Cart');
              $("#t div#search").append('</div>');
              $("#t div#search").append('</div>');
              $("#t div#search").append('</div>');

            });
          }
          else {
            $("#t div#all").show();
            $("#t div#search").empty();
            $("#t div#search").fadeIn("fast");
          }
        }
      });
      return false;
    });
  });
</script>

{% endblock %}
